<!--  Import della classe Charts.js (da spostare!!!) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<h1>Risultati Analisi Page</h1>

<div class="container mt-4">
    <h2 class="text-center mb-4">Questo è solo un esempio</h2>

    <!-- Riga per il layout con 3 colonne -->
    <div class="row">
        <div class="col-md-6">
            <!-- Colonna per il grafico a barre/montagna (sinistra) -->
            <div class="h-100">
                <canvas id="graficoBarreMontagna"></canvas>
            </div>
        </div>

        <!-- Colonna per i due grafici a barre (destra) -->
        <div class="col-md-6">
            <!-- Grafico a barre con valori positivi -->
            <div class="mb-4">
                <canvas id="barChart1"></canvas>
            </div>
            <!-- Questo è il grafico con valori positivi e negativi -->
            <div>
                <canvas id="barChart2"></canvas>
            </div>
        </div>
    </div>

</div>

<!-- Tabella di test con valori fittizzi -->
<div class="container mt-5">
    <div class="row">
        <!-- RIGA PER LA PRIMA TABELLA RIASSUNTIVA -->
        <div class="row">
            <div class="table-responsive" style="max-height: 400px; overflow-y: auto; overflow-x: auto">
                <table class="table-striped table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Gennaio</th>
                            <th>Febbraio</th>
                            <th>Marzo</th>
                            <th>Aprile</th>
                            <th>Maggio</th>
                            <th>Giugno</th>
                            <th>Luglio</th>
                            <th>Agosto</th>
                            <th>Settembre</th>
                            <th>Ottobre</th>
                            <th>Novembre</th>
                            <th>Dicembre</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2020</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>2021</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>2022</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>2023</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>2024</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- RIGA PER LA SECONDA TABELLA RIASSUNTIVA -->
        <div class="row">
            <div class="table-responsive">
                <table class="table-striped table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Gennaio</th>
                            <th>Febbraio</th>
                            <th>Marzo</th>
                            <th>Aprile</th>
                            <th>Maggio</th>
                            <th>Giugno</th>
                            <th>Luglio</th>
                            <th>Agosto</th>
                            <th>Settembre</th>
                            <th>Ottobre</th>
                            <th>Novembre</th>
                            <th>Dicembre</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td></td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                            <td>value</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row">
        <!-- Tabella a con tutti i dati  -->
        <div class="col-12 col-md-4">
            <table class="table-striped table table-bordered table-primary table-hovered">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Anno</th>
                        <th>Valore %</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="col-12 col-md-8">
            <div class="table-responsive">
                <table class="table-striped table">
                    <thead>
                        <tr>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                            <th>4</th>
                            <th>5</th>
                            <th>6</th>
                            <th>7</th>
                            <th>8</th>
                            <th>9</th>
                            <th>10</th>
                            <th>11</th>
                            <th>12</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>






<!-- AREA DI SCRIPT -->
<script>
    //SCRIPT PER IL GRAFICO A BARRE
    // Grafico a Barre (destra)
    let delayed = false;

    const ctxAlessio = document.getElementById('graficoBarreMontagna').getContext('2d');
    const grafic0Barre = new Chart(ctxAlessio, {
        type: 'bar',
        data: {
            labels: ['01/2020', '03/2020', '05/2020', '07/2020', '09/2020', '11/2020',
                     '01/2021', '03/2021', '05/2021', '07/2021', '09/2021', '11/2021',
                     '01/2022', '03/2022', '05/2022', '07/2022', '09/2022', '11/2022',
                     '01/2023', '03/2023', '05/2023', '07/2023', '09/2023', '11/2023',
                     '01/2024', '03/2024', '05/2024', '07/2024', '09/2024', '11/2024'],
            datasets: [{
                label: 'Andamento Percentuale',
                data: [5, 8, 15, 25, 35, 50, 70, 90, 120, 150, 180, 210, 250, 300, 350, 
                       1000, 1200, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 6000, 7000, 8000, 8500, 9000],
                fill: true,
                backgroundColor: 'rgba(0, 123, 255, 0.7)', // Colore di riempimento
                borderColor: 'rgba(0, 123, 255, 1)', // Colore del bordo
                borderWidth: 1, // Non serve un bordo troppo marcato
            }]
        },
        options: {
            animation: {
              onComplete: () => {
                delayed = true;
              },
              delay: (context) => {
                let delay = 0;
                if (context.type === 'data' && context.mode === 'default' && !delayed) {
                  delay = context.dataIndex * 100 + context.datasetIndex * 100;
                }
                return delay;
              },
            },
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    grid: {
                        display: true 
                    },
                    ticks: {
                        autoSkip: false,  // Assicura che tutte le etichette siano mostrate
                    },
                },
                y: {
                    beginAtZero: true,
                    grid: {
                        display: true // Mantiene la griglia dell'asse Y per la leggibilità
                    }
                }
            },
            categoryPercentage: 1.0, // Riempie completamente la categoria
            barPercentage: 1.0, // Assicura che le barre occupino tutto lo spazio della categoria
            plugins: {
                legend: {
                    display: true 
                },
                tooltip: {
                    enabled: true // Mantiene i tooltip per esplorare i dati
                }
            }
        }
    });


    // AREA BORDI DELLA TABELLA
    // var mountainCanvas = document.getElementById('mountainChart');
    // mountainCanvas.style.border = '2px solid #343a40';
    // mountainCanvas.style.borderRadius = '8px';

    // Primo grafico a barre (destra)
    var ctxBar1 = document.getElementById('barChart1').getContext('2d');
    var barChart1 = new Chart(ctxBar1, {
        type: 'bar',
        data: {
            labels: ['x', 'x', 'x', 'x', 'x', 'x'],
            datasets: [{
                label: 'Test valori',
                data: [10, 20, 15, 30, 25, 18],
                backgroundColor: 'rgba(13, 110, 253, 0.6)',  
                borderColor: 'rgba(13, 110, 253, 1)',        
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, // Impedisce di mantenere il rapporto di aspetto fisso
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // AREA BORDI DELLA TABELLA
    // var barCanvas1 = document.getElementById('barChart1');
    // barCanvas1.style.border = '2px solid #343a40';
    // barCanvas1.style.borderRadius = '8px';

    // Secondo grafico a barre (destra)
    var ctxBar2 = document.getElementById('barChart2').getContext('2d');
    var barChart2 = new Chart(ctxBar2, {
        type: 'bar',
        data: {
            labels: ['x', 'x', 'x', 'x', 'x', 'x'],
            datasets: [{
                label: 'Test valori pos e neg',
                data: [5, -10, 12, -15, 20, -17],
                backgroundColor: function (context) {
                    var value = context.dataset.data[context.dataIndex]; 
                    return value < 0 ? 'rgba(220, 53, 69, 0.6)' : 'rgba(13, 110, 253, 0.6)';
                },
                borderColor: function (context) {
                    var value = context.dataset.data[context.dataIndex];
                    return value < 0 ? 'rgba(220, 53, 69, 1)' : 'rgba(13, 110, 253, 1)';
                },
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,  // Permette di adattare il grafico alle dimensioni del contenitore
            scales: {
                y: {
                    beginAtZero: false,  // L'asse Y non inizia necessariamente da zero
                    min: -20,  // Imposta un minimo per l'asse Y per visualizzare i valori negativi
                    max: 30,   // Imposta un massimo per l'asse Y per evitare che il grafico esca dai limiti
                    ticks: {
                        stepSize: 5,  // Imposta la distanza tra i tick
                        callback: function (value) {
                            if (value === 0) {
                                return '0';
                            }
                            return value > 0 ? '+' + value : value;
                        }
                    }
                }
            }
        }
    });

    // AREA BORDI DELLA TABELLA
    // var barCanvas2 = document.getElementById('barChart2');
    // barCanvas2.style.border = '2px solid #343a40';
    // barCanvas2.style.borderRadius = '8px';
</script>